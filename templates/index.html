{% extends "base.html" %}
{% block title%}Leaderboard {%endblock%}
{% block head %}

	    <!-- get joining infos -->
		<script type="text/javascript">
		Handlebars.registerHelper('if_eq', function(a, b, opts) {
				if (a == b) {
					return opts.fn(this);
				} else {
					return opts.inverse(this);
				}
			});
			$(document).ready(function(){
				$.getJSON('https://api.sheety.co/15776791-1e6b-42a3-a1f6-76197c5926f4', function(data) {
					var template = Handlebars.compile($('#joinTemplate').html())
					$('#joinButton').html(template(data))
				})
			})
		</script>
		<!-- template for joining objects -->
		<script id="joinTemplate" type="text/x-handlebars-template">
				{% raw %}
			
				{{#each this}}
					{{#if_eq applicationIsOpen "no"}}
					<a href="https://discord.gg/jpVq9HE" class="">
						<div class="button button--sort">
							<span class="button__text button__text--thin">Join the <span class="button__text button__text--var">Game</span> (applications closed)</span>
						</div>
					</a>
					{{else}}
					<a href="https://forms.gle/zqRATLuCW3zDNNyC7" class="">
						<div class="button button--sort">
							<span class="button__text button__text--thin">Join the <span class="button__text button__text--var">Game</span> (applications closed)</span>
						</div>
					</a>
					{{/if_eq}}
					
				{{/each}}
				{% endraw %}
		</script>
{% endblock %}
{% block content %}
	<!-- buttons -->


	<a href="/rules" class="">
		<div class="button">
			<span class="button__text button__text--thin">Read the Rules</span>
		</div>
	</a>


	<div id="joinButton">
		<a href="" class="">
			<div class="button button--sort">
				<span class="button__text button__text--thin">Join the <span class="button__text button__text--var">Game</span> (applications closed)</span>
			</div>
		</a>
	</div>

	

	<!-- top spots -->
	<div class="fukol">
		<div class="fukol-grid">
			<div class="top-spot">
				<div class="top-spot__container">
					<div class="top-spot-award">
						<span class="top-spot-award__text">
							IN LEAD
						</span>
					</div>
					<div class="top-spot-user">
						<span class="top-spot-user__text">
							{{players[0][3]}}
						</span>
					</div>
				</div>
			</div>
			<div class="top-spot">
				<div class="top-spot__container">
					<div class="top-spot-award">
						<span class="top-spot-award__text">
							MOST KILLS
						</span>
					</div>
					<div class="top-spot-user">
						<span class="top-spot-user__text">
							{{kill_rank[0][3]}}
						</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- leaderboard -->
	{% for player in players %}
	<a href="javascript:alert('{{player[3]}} has killed {{player[1]}} {% if player[1] != 1 %}people{% else %}person{% endif %}')">
	<div class="leaderboard-item">
		<div class="leaderboard-item__container">
			<div class="leaderboard-user">
				<span class="leaderboard-user__text">{{player[3]}}</span> 
				<span class="leaderboard-user__subtext">{{player[0]}}</span> 
			</div>
			<div class="leaderboard-status leaderboard-status--desktop leaderboard-status--{% if loop.index == 1 %}first{% else %}{% if player[2] != 1 %}dead leaderboard-status--dead--button{%else%}not-top {%endif%}{% endif %}">
				<span class="leaderboard-status__text">{% if player[2] != 1 %}DEAD{%else%}{{player[1]}} kill{% if player[1] != 1 %}s{% endif %} {%endif%}</span>
			</div>
			<div class="leaderboard-status leaderboard-status--mobile leaderboard-status--{% if loop.index == 1 %}first{% else %}{% if player[2] != 1 %}dead leaderboard-status--dead--button{%else%}not-top {%endif%}{% endif %}">
				<span class="leaderboard-status__text">{% if player[2] != 1 %}DEAD{%else%}{{player[1]}} kill{% if player[1] != 1 %}s{% endif %} {%endif%}</span>
			</div>
		</div>
	</div>
	</a>
{% endfor %}
{% endblock %}
		